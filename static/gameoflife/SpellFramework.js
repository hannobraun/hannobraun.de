(function(){function f(){this.isRunningInBrowser=typeof window!="undefined",this.entities=new a,this.mainLoop=new c,this.isInitialized=!1,this._mainLoopDefinitionFunction=function(){},this._beforeLoadingInitializationFunction=function(){}}var a=require("spell/common/core/Entities"),b=require("spell/common/core/EntityUpdater"),c=require("spell/common/core/MainLoop"),d=require("spell/common/core/MainLoopDefinitionLanguage"),e=require("spell/common/core/MainLoopExecutor");f.prototype.beforeAssetsAreLoadedDo=function(a){this._beforeLoadingInitializationFunction=a},f.prototype.afterAssetsAreLoadedDo=function(a){this._afterLoadingInitializationFunction=a},f.prototype.defineMainLoop=function(a){this._mainLoopDefinitionFunction=a},f.prototype.run=function(){var a=this;a._beforeLoadingInitializationFunction(function(b){a._imageInformation=b});if(a._imageInformation==undefined||!this.isRunningInBrowser)a.isInitialized=!0,a._runMainLoop();else{var b=require("spell/browser/rendering/loadImagesAndPassTo");b(a._imageInformation,function(b){a._afterLoadingInitializationFunction(b),a.isInitialized=!0,a._runMainLoop()})}},f.prototype._runMainLoop=function(){var a=this,c=new d(a.mainLoop);c.interpret(a._mainLoopDefinitionFunction);var f=function(c){return new b(a.entities,c)},g=new e(a.entities,a.mainLoop,f);g.execute()},typeof window=="undefined"?module.exports=f:register("spell/common/core/SpellFramework",f)})()